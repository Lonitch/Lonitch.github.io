<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="/favicon.ico">
  <title>Sizhe's Skeleton of Kohn-Sham Approach</title>
  <meta name="description" content="1. Non-interacting Reference SystemFrom Hartrr-Fock approach we know that the Slater determinant is the wavefunction of non-interacting fermion system, where...">

  <!-- Google Fonts loaded here depending on setting in _data/options.yml true loads font, blank does not-->
  
    <link href='//fonts.googleapis.com/css?family=Lato:400,400italic' rel='stylesheet' type='text/css'>
  
  
<!-- Load up MathJax script if needed ... specify in /_data/options.yml file-->
  
    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: [
      "MathMenu.js",
      "MathZoom.js",
      "AssistiveMML.js",
      "a11y/accessibility-menu.js"
    ],
    jax: ["input/TeX", "output/CommonHTML"],
    TeX: {
      extensions: [
        "AMSmath.js",
        "AMSsymbols.js",
        "noErrors.js",
        "noUndefined.js",
      ]
    }
  });
</script>

<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>  


  <link rel="stylesheet" type="text/css" href="/css/tufte.css">
  <!-- <link rel="stylesheet" type="text/css" href="/css/print.css" media="print"> -->
  <style>
    /* Style for the table of contents */
    .toc {
      width: 100%; /* Full width */
      list-style: none;
      padding: 0;
    }
  
    /* Style for individual TOC items */
    .toc li {
      margin: 2px 0;
    }
  </style>
  <link rel="canonical" href="/articles/Kohn-Sham-Skeleton">

  <link rel="alternate" type="application/rss+xml" title="TuBTLE" href="/feed.xml" />
  <link rel="stylesheet" type="text/css" href="/Q/jsxgraph.css" />
  <script type="text/javascript" src="/Q/jsxgraphcore.js"></script>

  <link rel="stylesheet" type="text/css" href="/Q/Q.css">
	<link rel="stylesheet" type="text/css" href="/Q/Q-Circuit-Editor.css">

		<script src="https://www.googletagmanager.com/gtag/js" async></script>
		<script src="/Q/Q.js"></script>
		<script src="/Q/Q-ComplexNumber.js"></script>
		<script src="/Q/Q-Matrix.js"></script>
		<script src="/Q/Q-Qubit.js"></script>
		<script src="/Q/Q-Gate.js"></script>
		<script src="/Q/Q-History.js"></script>
		<script src="/Q/Q-Circuit.js"></script>
		<script src="/Q/Q-Circuit-Editor.js"></script>
    <script src="/Q/quantum-circuit.min.js"></script>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="/Q/Q-utils.js"></script>

</head>

  <body>
    <!--- Header and nav template site-wide -->
<header>
    <nav class="group">
	<a href="/"><img class="badge" src="/images/pubtit.png" alt="SIZHE"></a>
	
		
  	
		
		    
		      <a href="/tags/">Tags</a>
		    
	    
  	
		
		    
		      <a href="/archive/">Archive</a>
		    
	    
  	
		
		    
		      <a href="/">blog</a>
		    
	    
  	
		
		    
		      <a href="/about/">About</a>
		    
	    
  	
		
		    
		      <a href="/css/print.css"></a>
		    
	    
  	
		
		    
		      <a href="/style.css"></a>
		    
	    
  	
		
  	
	</nav>
</header>
    <article class="group">
      <h1>Skeleton of Kohn-Sham Approach</h1>
<p class="subtitle">August 31, 2020</p>
<div class="post-tags">
    <em>Tags: </em>
    <span class="post-tags">
    
    [handwriting] 
    
    [density-functional-theory] 
    
    </span>
</div>
<script>
// generate Q.js results whenever a circuit is evaluated 
window.addEventListener( 'Q.Circuit.evaluate completed', function( event ){
    const circuit = event.detail.circuit;
    qjs_caption_results(circuit);
})
// re-evaluate Q.js circuit when it's changed.
window.addEventListener( 'Q gui altered circuit', function( event ){
    event.detail.circuit.evaluate$()
})
</script>

<h2 id="1-non-interacting-reference-system">1. Non-interacting Reference System</h2>
<p>From Hartrr-Fock approach we know that the Slater determinant is the wavefunction of non-interacting fermion system, where the Hamiltonian is given by<!--more--></p>

\[\hat{\mathrm{H}}_{\mathrm{s}}=-\frac{1}{2} \sum_{\mathrm{i}}^{\mathrm{N}} \nabla_{\mathrm{i}}^{2}+\sum_{\mathrm{i}}^{\mathrm{N}} \mathrm{V}_{\mathrm{s}}\left(\mathrm{r}_{\mathrm{i}}\right)\tag{1.1},\]

<p>where \(V_s\) is the local potential. From (1.1) the one-electron Kohn-Sham operator is just</p>

\[\hat{\mathrm{f}}^{\mathrm{KS}}=-\frac{1}{2} \nabla^{2}+\mathrm{V}_{\mathrm{s}}(\overrightarrow{\mathrm{r}})\tag{1.2},\]

<p>with the one-electron Schrodinger equation being</p>

\[\hat{\mathrm{f}}^{KS} \varphi_{i}=\varepsilon_{i} \varphi_{i}\tag{1.3}\]

<p>with \(\varphi_i\) being Kohn-Sham orbitals. The primary purpose of Kohn-Sham approach is finding the effective local potential \(V_s(\vec{r})\) that gives the charge density distribution corresponding to the ground state, \(\rho_0(\vec{r})\), from which the ground state energy is calculated as</p>

\[E_0=F[\rho_0]+\int\rho_0(\vec{r})V_{Ne}d\vec{r}\tag{1.4},\]

<p>where the functional \(F[\rho]\) contains the contributions from electron kinetic, Coulombic, and quantum-mechanical energies,</p>

\[F[\rho]=T[\rho]+J[\rho]+E_{qm}[\rho]\tag{1.5}.\]

<h2 id="2-kohn-sham-equation">2. Kohn-Sham Equation</h2>
<p>We derive Kohn-Sham equation by first calculating the kinetic energy, \(T[\rho]\) in (1.5). In the non-interacting reference system, the kinetic energy is the expectation value of the operator \(\frac{1}{2}\nabla^2\) with \(m\) and \(\hbar\) being unity, i.e.,</p>

\[\mathrm{T}_{\mathrm{S}}=-\frac{1}{2} \sum_{\mathrm{i}}^{\mathrm{N}}\left\langle\varphi_{\mathrm{i}}\left|\nabla^{2}\right| \varphi_{\mathrm{i}}\right\rangle\tag{2.1}.\]

<p>Using \(T_s\), we can separate \(F[\rho]\) from (1.5) into three parts,</p>

\[F[\rho]=T_s[\rho]+J[\rho]+E_{xc}[\rho]\tag{2.2}\]

<p>where \(E_{xc}\) is the so-called “exchange-correlation” energy that caused by all the quantum-mechanical effects that we don’t know yet, and is defined as</p>

\[E_{xc}[\rho]=(T[\rho]-T_{s}[\rho])+(E_{ee}[\rho]-J[\rho])=T_c[\rho]+T_{qm}[\rho]\tag{2.3}.\]

<p>In an explicit form, (2.3) is then</p>

\[\begin{aligned}
\mathrm{E}[\rho(\overrightarrow{\mathrm{r}})] &amp;=\mathrm{T}_{\mathrm{S}}[\rho]+\mathrm{J}[\rho]+\mathrm{E}_{\mathrm{XC}}[\rho]+\mathrm{E}_{\mathrm{Ne}}[\rho] \\
&amp;=\mathrm{T}_{\mathrm{S}}[\rho]+\frac{1}{2} \iint \frac{\rho\left(\overrightarrow{\mathrm{r}}_{1}\right) \rho\left(\overrightarrow{\mathrm{r}}_{2}\right)}{\mathrm{r}_{12}} \mathrm{d} \overrightarrow{\mathrm{r}}_{1} \mathrm{d} \overrightarrow{\mathrm{d}}_{2}+\mathrm{E}_{\mathrm{XC}}[\rho]+\int \mathrm{V}_{\mathrm{Ne}} \rho(\overrightarrow{\mathrm{r}}) \mathrm{d} \overrightarrow{\mathrm{r}} \\
&amp;=-\frac{1}{2} \sum_{\mathrm{i}}^{\mathrm{N}}\left\langle\varphi_{\mathrm{i}}\left|\nabla^{2}\right| \varphi_{\mathrm{i}}\right\rangle+\frac{1}{2} \sum_{\mathrm{i}}^{\mathrm{N}} \sum_{\mathrm{j}}^{\mathrm{N}} \iint\left|\varphi_{\mathrm{i}}\left(\overrightarrow{\mathrm{r}}_{1}\right)\right|^{2} \frac{1}{\mathrm{r}_{12}}\left|\varphi_{\mathrm{j}}\left(\overrightarrow{\mathrm{r}}_{2}\right)\right|^{2} \mathrm{d} \overrightarrow{\mathrm{r}}_{1} \mathrm{d} \overrightarrow{\mathrm{r}}_{2} \\
&amp;+\mathrm{E}_{\mathrm{XC}}[\rho(\overrightarrow{\mathrm{r}})]-\sum_{\mathrm{i}}^{\mathrm{N}} \int \sum_{\mathrm{A}}^{\mathrm{M}} \frac{\mathrm{Z}_{\mathrm{A}}}{\mathrm{r}_{1 \mathrm{A}}}\left|\varphi_{\mathrm{i}}\left(\overrightarrow{\mathrm{r}}_{1}\right)\right|^{2} \mathrm{d} \overrightarrow{\mathrm{r}}_{1}.
\end{aligned}\tag{2.4}\]

<p>We apply the variational principle with the constraint of \(\langle\varphi_i\mid\varphi_j\rangle=\delta_{ij}\), we obtain the <strong>Kohn-Sham equation</strong> as</p>

\[\begin{array}{l}
\left(-\frac{1}{2} \nabla^{2}+\left[\int \frac{\rho\left(\overrightarrow{\mathrm{r}}_{2}\right)}{\mathrm{r}_{12}} \mathrm{d} \overrightarrow{\mathrm{r}}_{2}+\mathrm{V}_{\mathrm{XC}}\left(\overrightarrow{\mathrm{r}}_{1}\right)-\sum_{\mathrm{A}}^{\mathrm{M}} \frac{\mathrm{Z}_{\mathrm{A}}}{\mathrm{r}_{1 \mathrm{A}}}\right]\right) \varphi_{\mathrm{i}} \\
=\left(-\frac{1}{2} \nabla^{2}+\mathrm{V}_{\mathrm{eff}}\left(\overrightarrow{\mathrm{r}}_{1}\right)\right) \varphi_{\mathrm{i}}=\varepsilon_{\mathrm{i}} \varphi_{\mathrm{i}}
\end{array}\tag{2.5}.\]

<p>Comparing (2.5) with (1.3) we find</p>

\[V_S(\vec{r}) \equiv \mathrm{V}_{\mathrm{eff}}(\vec{r})=\int \frac{\rho\left(\vec{r_2}\right)}{\mathrm{r}_{12}} d \vec{r_2}+\mathrm{V}_{\mathrm{XC}}\left(\vec{\mathrm{r_1}}\right)-\sum_{A}^{M} \frac{Z_{A}}{r_{1A}}\tag{2.6}.\]

<p>Unlike the Hartree-Fock approach, the \(\varepsilon_i\) in (2.5) is <strong>not ionization energy, and has no solid physical meaning.</strong> The description above does not preassume any constriants, thus, <strong>Kohn-Sham approach is in principle exact if we use exact form of \(V_{xc}\).</strong></p>

<h2 id="3-exchange-correlation-functional-in-kohn-sham-scheme">3. Exchange-correlation Functional in Kohn-Sham Scheme</h2>
<p>In most modern implementation of density functional theory packages, the approxiamtions of \(E_{xc}[\rho]\) can be categorized into three types: local density approximation (LDA), generalized gradient approximation(GGA), and meta-GGA.  LDA usually takes the general form of</p>

\[E_{xc}^{LDA}[\rho]=\int\rho(\vec{r})\varepsilon_{xc}(\vec{r})d\vec{r}\tag{3.1},\]

<p>where the exchange-correlation function has exchange \(\varepsilon_x\) and correlation part \(\varepsilon_c\),</p>

\[\varepsilon_{xc}=\varepsilon_x+\varepsilon_c=-\frac{3}{4}(\frac{3\rho}{\pi})^{1/3}+\varepsilon_c\tag{3.2}.\]

<p>The exchange part \(\varepsilon_x\) is derived by Bloch and Dirac in the late 1920’s. The GGA takes the form of</p>

\[\mathrm{E}_{\mathrm{XC}}^{\mathrm{GGA}}\left[\rho_{\alpha}, \rho_{\beta}\right]=\int \mathrm{f}\left(\rho_{\alpha}, \rho_{\beta}, \nabla \rho_{\alpha}, \nabla \rho_{\beta}\right) \mathrm{d} \overrightarrow{\mathrm{r}}\tag{3.3}\]

<p>where \(\rho_{\alpha}\) are the electron density with the \(\alpha-\)spin. When the second-order derivative of charge density is used, we have another class of \(E_{XC}\) named as meta-GGA. In recent years, there is a rising star in the community of ExC functional called <em>hybrid function</em> defined as:</p>

\[E_{X C}^{h y b r i d}=E_{X C}^{G G A}+0.25\left(E_{X}^{H F}-E_{X}^{G G A}\right)\tag{3.4}.\]

<h2 id="4-the-failure-of-approximate-e_xcrho">4. The Failure of Approximate \(E_{XC}[\rho]\)</h2>

<p>The degeneracy of the spin states is the primary reason for the failure of various exchange-correlation functional. Take the \({}^2D\) state of the Scandium dication as an example. Its electron configuration is \(Ne(3s)^2(3p)^6(3d)^1\), and the \(3d\) electron could occupy any one of the orbitals: \(E_{d(x^2-y^2)}\), \(E_{dxz}\), \(E_{dz^2}\), \(E_{dyz}\), and \(E_{dxz}\). The energies of these five different configurations must have the same energy, but the DFT calculations predict different energy values. One of the active unsolved problem in the community of DFT research is: how to deal with degeneracies due to spin or non-Abelian spatial symmetry?</p>

<h2 id="5-basic-machinery-of-dft-programs">5. Basic Machinery of DFT Programs</h2>
<p>In this section how things in KS scheme are calculated in modern implementation of DFT packages are briefly introduced.</p>

<h3 id="51-linear-combined-atomic-orbital-lcao-ansatz">5.1 Linear-combined-atomic-orbital (LCAO) ansatz</h3>
<p>We simply expand the orbital function \(\varphi_i\) in (1.3) using LCAO ansatz,</p>

\[\varphi_i=\sum_i^Lc_{\mu i}\eta_{\mu}\tag{5.1}\]

<p>where \(\{\eta_i\}\) are \(L\) predefined base functions. Inserting (5.1) into (1.3) gives</p>

\[\hat{\mathrm{f}}^{\mathrm{KS}}\left(\overrightarrow{\mathrm{r}}_{1}\right) \sum_{\mathrm{v}=1}^{\mathrm{L}} \mathrm{c}_{\mathrm{vi}} \eta_{\mathrm{v}}\left(\overrightarrow{\mathrm{r}}_{1}\right)=\varepsilon_{\mathrm{i}} \sum_{\mathrm{v}=1}^{\mathrm{L}} \mathrm{c}_{\mathrm{vi}} \eta_{v}\left(\overrightarrow{\mathrm{r}}_{1}\right)\]

<p>Multiplying both sides above \(\eta_{\mu}(\vec{r_1})\) and integrating over \(\vec{r}_1\) gives</p>

\[\sum_{v=1}^{L} c_{v i} \int \eta_{\mu}\left(\vec{r}_{1}\right) \hat{f}^{K S}\left(\vec{r}_{1}\right) \eta_{v}\left(\vec{r}_{1}\right) d \vec{r}_{1}=\varepsilon_{i} \sum_{v=1}^{L} c_{v i} \int \eta_{\mu}\left(\vec{r}_{1}\right) \eta_{v}\left(\vec{r}_{1}\right) d \vec{r}_{1} \text { for } 1 \leq i \leq L\tag{5.2}.\]

<p>On the left side of (5.2)</p>

\[\mathrm{F}_{\mu v}^{\mathrm{KS}}=\int \eta_{\mu}\left(\overrightarrow{\mathrm{r}}_{1}\right) \hat{\mathrm{f}}^{\mathrm{KS}}\left(\overrightarrow{\mathrm{r}}_{1}\right) \eta_{\mathrm{v}}\left(\overrightarrow{\mathrm{r}}_{\mathrm{I}}\right) \mathrm{d} \overrightarrow{\mathrm{r}_{1}}\tag{5.3}\]

<p>is called <strong>Kohn-Sham matrix</strong> and the overlap matrix is defined as</p>

\[\mathrm{S}_{\mu \mathrm{v}}=\int \eta_{\mu}\left(\overrightarrow{\mathrm{r}}_{1}\right) \eta_{v}\left(\overrightarrow{\mathrm{r}}_{1}\right) \mathrm{d} \overrightarrow{\mathrm{r}}_{1}\tag{5.4}.\]

<p>If we further define a matrix</p>

\[\mathbf{C}=\left(\begin{array}{cccc}
\mathrm{c}_{11} &amp; \mathrm{c}_{12} &amp; \cdots &amp; \mathrm{c}_{1 \mathrm{L}} \\
\mathrm{c}_{21} &amp; \mathrm{c}_{22} &amp; \cdots &amp; \mathrm{c}_{2 \mathrm{L}} \\
\vdots &amp; \vdots &amp; &amp; \vdots \\
\mathrm{c}_{\mathrm{L} 1} &amp; \mathrm{c}_{\mathrm{L} 2} &amp; \cdots &amp; \mathrm{c}_{\mathrm{LL}}
\end{array}\right)\]

<p>and</p>

\[\boldsymbol{\varepsilon}=\left(\begin{array}{cccc}
\varepsilon_{1} &amp; 0 &amp; \cdots &amp; 0 \\
0 &amp; \varepsilon_{2} &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots &amp; &amp; \vdots \\
0 &amp; 0 &amp; \cdots &amp; \varepsilon_{\mathrm{L}}
\end{array}\right)\]

<p>Eq.(5.2) can be casted into a matrix format as</p>

\[\mathbf{F}^{\mathrm{KS}} \mathbf{C}=\mathbf{S} \mathbf{C} \boldsymbol{\varepsilon}\tag{5.5}.\]

<p>Therefore, the problem of solving K-S equations is expressed in the language of linear algebra.</p>

<h3 id="52-basic-set">5.2 Basic set</h3>

<p>The utmost important element of LCAO ansatz described above is the basis functions \(\eta_i\). Now we introduce several sets of basis functions. The first type is called <em>Gaussian-type-orbitals</em>, and is defined as</p>

\[\eta^{G T O}=N x^{l} y^{m} z^{n} \exp \left[-\alpha r^{2}\right]\tag{5.6}\]

<p>where \(L=l+m+n\) is used to classify the GTO as s-functions \((\mathrm{L}=0), \mathrm{p}\) -functions \((\mathrm{L}=1), \mathrm{d}-\) functions \((\mathrm{L}=2),\) etc. The second basis set is called <em>Slater-type</em>, i.e.,</p>

\[\eta^{\mathrm{STO}}=\mathrm{N} \mathrm{r}^{\mathrm{n}-1} \exp [-\zeta \mathrm{r}] \mathrm{Y}_{\mathrm{Im}}(\Theta, \phi)\tag{5.7}.\]

<p>And the <em>plane-wave</em> set,</p>

\[\eta^{\mathrm{PW}}=\exp [\mathrm{i} \vec{\mathrm{k}} \vec{\mathrm{r}}]\tag{5.8}.\]

<h2 id="conclusion">Conclusion</h2>

<p>I probably should spend more time with DFT these days as I expect to apply some interesting first-principle methods to probe the magnetic and electronic properties of various electroactive materials. This blog introduces K-S approach from a chemist perspective, where everything is boiled down to simple terms and does not require advanced prerequisite.</p>

<br>
<hr style="border:none;height:1.0px;background-image:linear-gradient(to right, #fff, #333, #fff);">
<br>
<!-- <script src="https://utteranc.es/client.js"
        repo="Lonitch/Lonitch.github.io"
        issue-term="pathname"
        label="comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script> -->
<script src="https://giscus.app/client.js"
        data-repo="Lonitch/Lonitch.github.io"
        data-repo-id="MDEwOlJlcG9zaXRvcnkyNjI5MjYyNzI="
        data-category="General"
        data-category-id="DIC_kwDOD6vvwM4CZPCU"
        data-mapping="title"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="light"
        data-lang="en"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
</script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        // add class to toc list
        const ulElements = document.querySelector('article').querySelectorAll('ul');
        let tocElement = null;

        // Iterate through the <ul> elements and find the one with <li> containing <a>
        ulElements.forEach((ul,i) => {
        const liWithA = ul.querySelectorAll('li a');
        const li = ul.querySelectorAll('li');
        if (liWithA.length == li.length && i==0) {
            tocElement = ul;
            tocElement.setAttribute('class','toc-list')
        }
        });
        // add interactive circuit to all elements with class "Q-circuit-palette"
        Array
        .from( document.querySelectorAll( '.Q-circuit-palette' ))
        .forEach( function(el){
            Q.Circuit.Editor.createPalette(el)
        })
        // create numbered indice for figures and equations
        eqn_fig_indices();

        // shut down display of mjx-container in margin notes
        MathJax.startup.promise.then(function() {
            findMjxContainersInMarginNotes();
        });

        // create references to equations or figures
        eqn_fig_refs();

        // create Index
        createIndex();
        window.addEventListener('resize', createIndex);
    });
</script>

    </article>
    <span class="print-footer">Skeleton of Kohn-Sham Approach - August 31, 2020 - Sizhe Liu</span>
    <footer>
  <hr class="slender">
  <ul class="footer-links">
    <!-- <li><a href="mailto:hate@spam.net"><span class="icon-mail3"></span></a></li>     -->
    
      <li>
        <a href="https://github.com/Lonitch"><span class="icon-github"></span></a>
      </li>
      
  </ul>
<div class="credits">
<span>&copy; 2024 &nbsp;&nbsp;SIZHE LIU</span></br> <br>
<span>This site created with the <a href="//github.com/Lonitch/Lonitch.github.io">Tufte Blog Theme with Latex-like Elements</a> in <a href="//jekyllrb.com">Jekyll</a>.</span> 
</div>  
</footer>
  </body>
</html>
