
TL;DR: Density Matrix and State Vector are the two mathematical arenas for doing calculations based on the postulates of QM. In this note we discuss intrinsic characteristics of Density Matrix, and its relation with quantum computation. Density operator and Density matrix are used interchangeably in the text.

## Postulates of Quantum Mechanics, Recasted
In the State Vector Formalism(SVF), we use state vector $|\phi\rangle$, which lives on inner product space $V$, to describe status of an isolated quantum system. And the evolution of such a system is described by Schrodinger Eqn.:

$$
i\hbar\frac{\partial |\phi\rangle}{\partial t}=\mathcal{H}|\phi\rangle\tag{1}
$$

where $\mathcal{H}$ is the Hamiltonian of the system. The state at $t_1$, $|\phi_1\rangle$ and $|\phi_2\rangle$ at $t_2$ are related by unitary operator $U$, i.e.,

$$
|\phi_2\rangle = U|\phi_1\rangle\tag{2}
$$

With this, we dive into the Density Matrix Formalism(DMF), in which the "states" of a quantum system is described by a matrix $|\phi_i\rangle\langle\phi_i|$ with $\phi_i$ being a possible **pure state** of the quantum system in SVF. The pure states in SVF are the ones we already know, like the eigen-states of 1D/2D/3D potential well. DMF assigns each possible state(matrix) a probability $p_i\in(0,1]$, and the collection of $\{p_i,|\phi_i\rangle\}$ is referred as the **ensemble of pure states.** With this, the density operator is defined as

$$
\rho=\sum_i^dp_i|\phi_i\rangle\langle\phi_i|\tag{3}
$$

where $d$ is the dimension of some Hilbert space that Hamiltonian of the quantum system acts on. From elementary statistical theory, we have $\sum_ip_i=1$. The pure state in DMF is made of only one of the "state", i.e.,

$$
\rho=|\phi\rangle\langle\phi|\tag{4}
$$

With this, we define **mixed state** of a quantum system as

$$
\rho=\sum_i^{l\leq d}p_i|\phi_i\rangle\langle\phi_i|.\tag{5}
$$

With these definitions, we can see that 

$$
tr(\rho^2)<1 \text{\quad for mixed state}
$$

and

$$
tr(\rho^2)=1 \text{\quad for pure state}.
$$


As an analogue to Eqn.(2) in DMF, we now relate the states at two consecutive time instances, $t_1\text{ and }t_2$, by using the following,

$$
\rho_{(t=t_2)} = \sum_ip_iU|\phi_i(t_1)\rangle\langle\phi_i(t_1)|U^{\dagger}
=U\rho_{(t=t_1)}U^{\dagger}.\tag{6}
$$

Eqn.(6) gives a way to describe the evolution of a quantum system in DMF. We now need a way to describe the measurement applied on quantum systems in DMF. Assume that the system of our interest is initially at state of $|\phi_i\rangle$, on which we apply a measurement operator $M_m$. The subscript here is the index of a possible outcome of such a measurement. The conditional possibility of getting the outcome $m$ when the state is then

$$
p(m|i)=\langle\phi_i|M^{\dagger}_mM_m|\phi_i\rangle=tr(M_m^{\dagger}M_m|\phi_i\rangle\langle\phi_i|).\tag{7}
$$

The last equality can be seen by writing out the trace of $M_m^{\dagger}M_m|\phi_i\rangle\langle\phi_i|$ as

$$
tr(M_m^{\dagger}M_m|\phi_i\rangle\langle\phi_i|) = \sum_i\langle i|M_m^{\dagger}M_m|\phi_i\rangle\langle\phi_i|i\rangle = \langle\phi_i|\left(\sum_i|i\rangle\langle i|\right)|M_m^{\dagger}M_m|\phi_i\rangle
$$

Since ${|i\rangle}$ is an orthonormal basis, we must have Eqn.(7). With $p(m|i)$ and $p_i$ from (5), the possibility of getting $m$ from a mixed state is then 

$$
p(m) = \sum_ip(m|i)p_i=tr\left(M^{\dagger}_mM_m\sum_ip_i|\phi_i\rangle\langle\phi_i|\right)=tr(M^{\dagger}_mM_m\rho)\tag{8}.
$$

After the measurement $M_m$, we get a new ensemble of states $|\phi_i^m\rangle$.  The corresponding density operator is then become

$$
\rho_m=\sum_ip(i|m)|\phi_i^m\rangle\langle\phi_i^m|=\sum_ip(i|m)\frac{M_m|\phi_i\rangle\langle\phi_i|M_m^{\dagger}}{\langle\phi_i|M^{\dagger}_mM_m|\phi_i\rangle}.\tag{9}
$$

Note that $p(i|m)=p(i,m)/p(m)=p(m|i)p_i/p(m)$, we substitute (7) and (8) into (9) to give

$$
\rho_m = \sum_ip_i\frac{M_m|\phi_i\rangle\langle\phi_i|M_m^{\dagger}}{tr(M^{\dagger}_mM_m\rho)}=\frac{M_m\rho M_m^{\dagger}}{tr(M^{\dagger}_mM_m\rho)}\tag{10}.
$$

In the context of quantum computing, if we have some noises in the system right after the measurement, we lose the result $m$ of our measurement. Then our quantum system might be at the mixed state $\rho_m$ with probability of $p(m)$. In such a case, we get a mixture of different density operators as

$$
\sum_mp(m)\rho_m=\sum_m M_m \rho M_m^{\dagger}\tag{11}.
$$

We are now at a good position to recast the postulates of QM as the following(from Mike and Ike):
1. Associated to any isolated physical system is a complex vector space with inner product (that is, a Hilbert space) known as the state space of the system. The system is completely described by its density operator, which is a positive operator $\rho$ with trace one, acting on the state space of the system. If a quantum system is in the state $\rho_i$ with probability $p_i$, then the density operator for the system is $\sum_i p_i \rho_i$.
2. The evolution of a closed quantum system is described by a unitary transformation. That is, the state $\rho$ of the system at time $t_1$ is related to the state $\rho^{\prime}$ of the system at time $t_2$ by a unitary operator $U$ which depends only on the times $t_1$ and $t_2$

$$
\rho^{\prime}=U \rho U^{\dagger}
$$

3. Quantum measurements are described by a collection $\left\{M_m\right\}$ of measurement operators. These are operators acting on the state space of the system being measured. The index $m$ refers to the measurement outcomes that may occur in the experiment. If the state of the quantum system is $\rho$ immediately before the measurement then the probability that result $m$ occurs is given by

$$
p(m)=\operatorname{tr}\left(M_m^{\dagger} M_m \rho\right)
$$

and the state of the system after the measurement is

$$
\frac{M_m \rho M_m^{\dagger}}{\operatorname{tr}\left(M_m^{\dagger} M_m \rho\right)}
$$

The measurement operators satisfy the completeness equation,

$$
\sum_m M_m^{\dagger} M_m=I
$$

4. The state space of a composite physical system is the tensor product of the state spaces of the component physical systems. Moreover, if we have systems numbered 1 through $n$, and system number $i$ is prepared in the state $\rho_i$, then the joint state of the total system is $\rho_1 \otimes \rho_2 \otimes \ldots \rho_n$.

### General properties of density matrix
A density matrix must have the following properties:
- $tr(\rho)=1$
- $\rho$ is a positive matrix

## Bloch sphere for mixed states(Exercise 2.72 from Mike&Ike)
Show that an arbitrary density matrix for a mixed state qubit may be written as

$$
\rho=\frac{I+\vec{r} \cdot \vec{\sigma}}{2},
$$

where $\vec{r}$ is a real three-dimensional vector such that $\|\vec{r}\| \leq 1$. This vector is known as the Bloch vector for the state $\rho$.

The pure state in SVF can be represented by unit vector on the Bloch sphere, with its expression being:

$$
|\psi\rangle=\cos \frac{\theta}{2}|0\rangle+e^{i \phi} \sin \frac{\theta}{2}|1\rangle
$$

So, the pure state in DMF is then

$$
\rho=|\psi\rangle\langle\psi|=\left[\begin{array}{cc}
\cos ^2(\theta / 2) & \cos (\phi) \cos (\theta / 2) \sin (\theta / 2)-i \sin (\phi) \cos (\theta / 2) \sin (\theta / 2) \\
\cos (\phi) \cos (\theta / 2) \sin (\theta / 2)+i \sin (\phi) \cos (\theta / 2) \sin (\theta / 2) & 1-\cos ^2(\theta / 2)
\end{array}\right]
$$

And we have here $tr(\rho)=1$. Let $\vec{r}=(r_1,r_2,r_3)^T$, $\rho$ should be in a form of

$$
\frac{1}{2}\left[\begin{array}{cc}
1+r_3 & r_1-i r_2 \\
r_1+i r_2 & 1-r_3
\end{array}\right]
$$

To make it work, we must have

$$
\begin{gathered}
2 \cos ^2(\theta / 2)=1+r_3 \\
r_3=2 \cos ^2(\theta / 2)-1 \\
r_1=2 \cos (\phi) \cos (\theta / 2) \sin (\theta / 2) \\
r_2=2 \sin (\phi) \cos (\theta / 2) \sin (\theta / 2)
\end{gathered}
$$

With these, it can be shown that $|r|=1$. For a mixed state, we have $\rho=\sum p_k|\psi_k\rangle\langle \psi_k|$. Using state vector definition of $|\phi_i\rangle$, the density matrix is now

$$
\rho=\left[\begin{array}{cc}
\sum_kp_k\cos ^2(\theta_k / 2) & \sum_kp_k\cos (\phi_k) \cos (\theta_k / 2) \sin (\theta_k / 2)-\sum_kp_ki \sin (\phi_k) \cos (\theta_k / 2) \sin (\theta_k / 2) \\
\sum_kp_k\cos (\phi_k) \cos (\theta_k / 2) \sin (\theta_k / 2)+\sum_kp_ki \sin (\phi_k) \cos (\theta_k / 2) \sin (\theta_k / 2) & \sum_kp_k(1-\cos ^2(\theta_k / 2))
\end{array}\right]
$$

Let $\vec{r}_k=(r_{k1},r_{k2},r_{k3})^T$ to be the **Bloch vector** for pure state $|\phi_i\rangle\langle\phi_i|$, so we have

$$
\begin{gathered}
r_{k3}=2 \cos ^2(\theta_k / 2)-1 \\
r_{k1}=2 \cos (\phi_k) \cos (\theta_k / 2) \sin (\theta_k / 2) \\
r_{k2}=2 \sin (\phi_k) \cos (\theta_k / 2) \sin (\theta_k / 2)
\end{gathered}
$$

Because $\sum_kp_k=1$, the matrix above can be represented as

$$
\rho=\left[\begin{array}{cc}
\frac{1}{2}\sum_kp_k(1+r_{k3}) & \frac{1}{2}\sum_kp_k(r_{k1}-ir_{k2}) \\
\frac{1}{2}\sum_kp_k(r_{k1}+ir_{k2}) & \frac{1}{2}\sum_kp_k(1-r_{k3})
\end{array}\right]=\frac{I+\sum_kp_k\vec{r}_k\cdot\mathbb{\sigma}}{2}
$$

Since $||\sum_kp_k\vec{r}_k||\leq\sum_kp_i||\vec{r}_k||=1$, we now understand that **the mixed state is represented by a vector $\sum_kp_k\vec{r}_k$ that has its head inside Bloch sphere.**

## Unitary freedom in the ensemble for density matrices

The **theorem of unitary freedom** is stated as: the sets $\left\{|\tilde{\psi}_i\rangle\right\}$ and $\left\{|\tilde{\varphi}_j\rangle\right\}$ generate the same density matrix if and only if

$$
\left|\tilde{\psi}_i\right\rangle=\sum_j u_{i j}\left|\tilde{\varphi}_j\right\rangle\tag{12}
$$

where $u_{i j}$ is a unitary matrix of complex numbers, with indices $i$ and $j$, and we 'pad' whichever set of vectors $\left|\tilde{\psi}_i\right\rangle$ or $\left|\tilde{\varphi}_j\right\rangle$ is smaller with additional vectors 0 so that the two sets have the same number of elements. 

As a consequence of the theorem, note that $\rho=\sum_i p_i|\psi_i\rangle\langle\psi_i|=\sum_j q_j| \varphi_j\rangle\langle\varphi_j|$ for normalized states $\left|\psi_i\right\rangle,\left|\varphi_j\right\rangle$ and probability distributions $p_i$ and $q_j$ if and only if

$$
\sqrt{p_i}\left|\psi_i\right\rangle=|\tilde{\psi}_i\rangle=\sum_j u_{i j} \sqrt{q_j}\left|\varphi_j\right\rangle.
$$

Let $U$ be the unitary matrix with its element being $u_{ij}$, and we see the two sets are related as

$$
[|\tilde{\psi}_1\rangle \cdots|\tilde{\psi}_k\rangle]=\left[\left|\tilde{\varphi}_1\right\rangle \cdots\left|\tilde{\varphi}_k\right\rangle\right] U^T.\tag{13}
$$

Exercise 2.73 from Mike and Ike: Let $\rho$ be a density operator. A minimal ensemble for $\rho$ is an ensemble $\left\{p_i,\left|\psi_i\right\rangle\right\}$ containing a number of elements equal to the rank of $\rho$. Let $|\psi\rangle$ be any state in the support of $\rho$. (The support of a Hermitian operator $A$ is the vector space spanned by the eigenvectors of $A$ with non-zero eigenvalues.) Show that there is a minimal ensemble for $\rho$ that contains $|\psi_i\rangle$, and moreover that in any such ensemble $|\psi_i\rangle$ must appear with probability

$$
p_i=\frac{1}{\left\langle\psi_i\left|\rho^{-1}\right| \psi_i\right\rangle}\tag{14}
$$

where $\rho^{-1}$ is defined to be the inverse of $\rho$, when $\rho$ is considered as an operator acting only on the support of $\rho$. (This definition removes the problem that $\rho$ may not have an inverse.)

SOLUTION: From spectral theorem, density matrix $\rho$ is decomposed as $\rho=\sum_{k=1}^d \lambda_k|k\rangle\langle k|$ where $d=$ $\operatorname{dim} \mathcal{H}$. Without loss of generality, we can assume $p_k>0$ for $k=1 \cdots, l$ where $l=\operatorname{rank}(\rho)$ and $p_k=0$ for $k=l+1, \cdots, d$. Thus $\rho=\sum_{k=1}^l p_k|k\rangle\langle k|=\sum_{k=1}^l| \tilde{k}\rangle\langle\tilde{k}|$, where $|\tilde{k}\rangle=\sqrt{\lambda_k}|k\rangle$. For any state vector $|\psi_i\rangle$, we can write

$$
\left|\psi_i\right\rangle=\sum_{k=1}^l c_{i k}|k\rangle.\tag{15}
$$

Because state vectors are unit vectors, we have $\sum_k\left|c_{i k}\right|^2=1$. To find the minimal ensemble that  contains $|\psi_i\rangle$, we construct a new set $\{|\psi_i\rangle\}$ that shares the same unitary freedom with $\{|k\rangle\}$. To do so, we must find the unitary matrix that relates the two sets(eqn.13). Notice that if $|\psi_i\rangle$ is in the minimal ensemble, we can associate it with a probability $p_i$. From (15), we have

$$
|\tilde{\psi}_i\rangle=\sum_k^l\frac{\sqrt{p_i}c_{ik}}{\sqrt{\lambda_k}}|\tilde{k}\rangle.\tag{16}
$$

If we let $u_{ik}=\frac{\sqrt{p_i}c_{ik}}{\sqrt{\lambda_k}}$, and to make the row vector $\vec{u}_i=_[u_{i1},u_{i2},...u_{il}]$ normalized, we have 

$$
p_i\sum_k^l\frac{|c_{ik}|^2}{\lambda_k}=1\rightarrow p_i=\frac{1}{\sum_k^l\frac{|c_{ik}|^2}{\lambda_k}}.\tag{17}
$$

Using Gram-Schmit procedure, we can construct the unitary matrix $U$ as 

$$
U=\left[\begin{array}{c}
\vec{u}_1 \\
\vdots \\
\vec{u}_i \\
\vdots \\
\vec{u}_l
\end{array}\right]
$$

Because the row vectors in the matrix above are orthonormal, we have $U^{\dagger}U=I$. From (16) we find other members in the minimal ensemble through the following relation:

$$
\left[\left|\tilde{\psi}_1\right\rangle \cdots\left|\tilde{\psi}_i\right\rangle \cdots\left|\tilde{\psi}_l\right\rangle\right]=\left[\left|\tilde{k}_1\right\rangle \cdots\left|\tilde{k}_l\right\rangle\right] U^T\tag{18}
$$

So that

$$
\sum_i|\tilde{\psi}_i\rangle\langle\tilde { \psi } _ { i }|=\left[|\tilde{\psi}_1\rangle \cdots|\tilde{\psi}_k\rangle\right]\left[\begin{array}{c}
\langle\tilde{\psi}_1| \\
\vdots \\
\langle\tilde{\psi}_k|
\end{array}\right]
$$

$$
\begin{aligned}
&=\left[\left|\tilde{k}_1\right\rangle \cdots\left|\tilde{k}_k\right\rangle\right] U^T U^*\left[\begin{array}{c}
\left\langle\tilde{k}_1\right| \\
\vdots \\
\left\langle\tilde{k}_k\right|
\end{array}\right] \\
&=\left[\left|\tilde{k}_1\right\rangle \cdots\left|\tilde{k}_k\right\rangle\right]\left[\begin{array}{c}
\left\langle\tilde{k}_1\right| \\
\vdots \\
\left\langle\tilde{k}_k\right|
\end{array}\right] \\
&=\sum_j\left|\tilde{k}_j\right\rangle\left\langle\tilde{k}_j\right|
\end{aligned}
$$

To obtain (14), we notice that $\rho^{-1}=\sum_k\frac{1}{\lambda_k}|k\rangle\langle k|$, and use (15), we can show that

$$
\left\langle\psi_i\left|\rho^{-1}\right| \psi_i\right\rangle=\sum_k^l\frac{|c_{ik}|^2}{\lambda_k}=1/p_i
$$

as indicated in (17).
